## Prep LFS data for analysis
#############################

library(foreign)
library(tidyverse)

inpath = 'data/raw/'
outpath = 'data/'

lfs2016a <- read.dta(paste0(inpath,"lfsp_jm16_eul.dta"), convert.factors = FALSE)
lfs2016b <- read.dta(paste0(inpath,"lfsp_aj16_eul.dta"), convert.factors = FALSE)
lfs2016c <- read.dta(paste0(inpath,"lfsp_js16_eul.dta"), convert.factors = FALSE)
lfs2016d <- read.dta(paste0(inpath,"lfsp_od16_eul.dta"), convert.factors = FALSE)
lfs2015a <- read.dta(paste0(inpath,"lfsp_jm15_eul.dta"), convert.factors = FALSE)
lfs2015b <- read.dta(paste0(inpath,"lfsp_aj15_eul.dta"), convert.factors = FALSE)
lfs2015c <- read.dta(paste0(inpath,"lfsp_js15_eul.dta"), convert.factors = FALSE)
lfs2015d <- read.dta(paste0(inpath,"lfsp_od15_eul.dta"), convert.factors = FALSE)
lfs2014a <- read.dta(paste0(inpath,"lfsp_jm14_eul.dta"), convert.factors = FALSE)
lfs2014b <- read.dta(paste0(inpath,"lfsp_aj14_eul.dta"), convert.factors = FALSE)
lfs2014c <- read.dta(paste0(inpath,"lfsp_js14_eul.dta"), convert.factors = FALSE)
lfs2014d <- read.dta(paste0(inpath,"lfsp_od14_eul.dta"), convert.factors = FALSE)
lfs2013a <- read.dta(paste0(inpath,"lfsp_jm13_eul.dta"), convert.factors = FALSE)
lfs2013b <- read.dta(paste0(inpath,"lfsp_aj13_eul.dta"), convert.factors = FALSE)
lfs2013c <- read.dta(paste0(inpath,"lfsp_js13_eul.dta"), convert.factors = FALSE)
lfs2013d <- read.dta(paste0(inpath,"lfsp_od13_eul.dta"), convert.factors = FALSE)

lfs2016a.s <- lfs2016a %>% select(CASENOP, THISWV, PWT16, PIWT16, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR)
lfs2016b.s <- lfs2016b %>% select(CASENOP, THISWV, PWT16, PIWT16, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2016c.s <- lfs2016c %>% select(CASENOP, THISWV, PWT16, PIWT16, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR)
lfs2016d.s <- lfs2016d %>% select(CASENOP, THISWV, PWT16, PIWT16, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2015a.s <- lfs2015a %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR)
lfs2015b.s <- lfs2015b %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2015c.s <- lfs2015c %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR)
lfs2015d.s <- lfs2015d %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2014a.s <- lfs2014a %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2014b.s <- lfs2014b %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2014c.s <- lfs2014c %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR)
lfs2014d.s <- lfs2014d %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2013a.s <- lfs2013a %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2013b.s <- lfs2013b %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR, FLEXW7)
lfs2013c.s <- lfs2013c %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, TTUSHR)
lfs2013d.s <- lfs2013d %>% select(CASENOP, THISWV, PWT17, PIWT17, FTPTW, HOURPAY, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, WHYTMP6, FLEXW7, TTUSHR)

lfs2016a.s$YEAR <- rep(2016,nrow(lfs2016a.s))
lfs2016b.s$YEAR <- rep(2016,nrow(lfs2016b.s))
lfs2016c.s$YEAR <- rep(2016,nrow(lfs2016c.s))
lfs2016d.s$YEAR <- rep(2016,nrow(lfs2016d.s))
lfs2015a.s$YEAR <- rep(2015,nrow(lfs2015a.s))
lfs2015b.s$YEAR <- rep(2015,nrow(lfs2015b.s))
lfs2015c.s$YEAR <- rep(2015,nrow(lfs2015c.s))
lfs2015d.s$YEAR <- rep(2015,nrow(lfs2015d.s))
lfs2014a.s$YEAR <- rep(2014,nrow(lfs2014a.s))
lfs2014b.s$YEAR <- rep(2014,nrow(lfs2014b.s))
lfs2014c.s$YEAR <- rep(2014,nrow(lfs2014c.s))
lfs2014d.s$YEAR <- rep(2014,nrow(lfs2014d.s))
lfs2013a.s$YEAR <- rep(2013,nrow(lfs2013a.s))
lfs2013b.s$YEAR <- rep(2013,nrow(lfs2013b.s))
lfs2013c.s$YEAR <- rep(2013,nrow(lfs2013c.s))
lfs2013d.s$YEAR <- rep(2013,nrow(lfs2013d.s))

lfs2016a.s$QUARTER <- rep(1,nrow(lfs2016a.s))
lfs2016b.s$QUARTER <- rep(2,nrow(lfs2016b.s))
lfs2016c.s$QUARTER <- rep(3,nrow(lfs2016c.s))
lfs2016d.s$QUARTER <- rep(4,nrow(lfs2016d.s))
lfs2015a.s$QUARTER <- rep(1,nrow(lfs2015a.s))
lfs2015b.s$QUARTER <- rep(2,nrow(lfs2015b.s))
lfs2015c.s$QUARTER <- rep(3,nrow(lfs2015c.s))
lfs2015d.s$QUARTER <- rep(4,nrow(lfs2015d.s))
lfs2014a.s$QUARTER <- rep(1,nrow(lfs2014a.s))
lfs2014b.s$QUARTER <- rep(2,nrow(lfs2014b.s))
lfs2014c.s$QUARTER <- rep(3,nrow(lfs2014c.s))
lfs2014d.s$QUARTER <- rep(4,nrow(lfs2014d.s))
lfs2013a.s$QUARTER <- rep(1,nrow(lfs2013a.s))
lfs2013b.s$QUARTER <- rep(2,nrow(lfs2013b.s))
lfs2013c.s$QUARTER <- rep(3,nrow(lfs2013c.s))
lfs2013d.s$QUARTER <- rep(4,nrow(lfs2013d.s))

lfs2016a.s$Y_Q <- rep(2016.1,nrow(lfs2016a.s))
lfs2016b.s$Y_Q <- rep(2016.2,nrow(lfs2016b.s))
lfs2016c.s$Y_Q <- rep(2016.3,nrow(lfs2016c.s))
lfs2016d.s$Y_Q <- rep(2016.4,nrow(lfs2016d.s))
lfs2015a.s$Y_Q <- rep(2015.1,nrow(lfs2015a.s))
lfs2015b.s$Y_Q <- rep(2015.2,nrow(lfs2015b.s))
lfs2015c.s$Y_Q <- rep(2015.3,nrow(lfs2015c.s))
lfs2015d.s$Y_Q <- rep(2015.4,nrow(lfs2015d.s))
lfs2014a.s$Y_Q <- rep(2014.1,nrow(lfs2014a.s))
lfs2014b.s$Y_Q <- rep(2014.2,nrow(lfs2014b.s))
lfs2014c.s$Y_Q <- rep(2014.3,nrow(lfs2014c.s))
lfs2014d.s$Y_Q <- rep(2014.4,nrow(lfs2014d.s))
lfs2013a.s$Y_Q <- rep(2013.1,nrow(lfs2013a.s))
lfs2013b.s$Y_Q <- rep(2013.2,nrow(lfs2013b.s))
lfs2013c.s$Y_Q <- rep(2013.3,nrow(lfs2013c.s))
lfs2013d.s$Y_Q <- rep(2013.4,nrow(lfs2013d.s))

lfs2016a.s$FLEXW7 <- rep(NA,nrow(lfs2016a.s))
lfs2016c.s$FLEXW7 <- rep(NA,nrow(lfs2016c.s))
lfs2015a.s$FLEXW7 <- rep(NA,nrow(lfs2015a.s))
lfs2015c.s$FLEXW7 <- rep(NA,nrow(lfs2015c.s))
lfs2014a.s$FLEXW7 <- rep(NA,nrow(lfs2014a.s))
lfs2014c.s$FLEXW7 <- rep(NA,nrow(lfs2014c.s))
lfs2013a.s$FLEXW7 <- rep(NA,nrow(lfs2013a.s))
lfs2013c.s$FLEXW7 <- rep(NA,nrow(lfs2013c.s))

lfs2016a.s <- rename(lfs2016a.s, c("PIWT17"= "PIWT16", "PWT17" = "PWT16"))
lfs2016b.s <- rename(lfs2016b.s, c("PIWT17"="PIWT16", "PWT17"="PWT16"))
lfs2016c.s <- rename(lfs2016c.s, c("PIWT17"="PIWT16", "PWT17"="PWT16"))
lfs2016d.s <- rename(lfs2016d.s, c("PIWT17"="PIWT16", "PWT17"="PWT16"))

lfs13.16 <- rbind(lfs2016a.s, lfs2016b.s, lfs2016c.s, lfs2016d.s,
                  lfs2015a.s, lfs2015b.s, lfs2015c.s, lfs2015d.s,
                  lfs2014a.s, lfs2014b.s, lfs2014c.s, lfs2014d.s,
                  lfs2013a.s, lfs2013b.s, lfs2013c.s, lfs2013d.s)
write_csv(lfs13.16, paste0(outpath, "lfs_13-16.csv"))

#part 2
lfs2007a <- read.dta(paste0(inpath,"lfsp_jm07_end_user.dta"), convert.factors = FALSE)
lfs2007b <- read.dta(paste0(inpath,"lfsp_aj07_end_user.dta"), convert.factors = FALSE)
lfs2007c <- read.dta(paste0(inpath,"lfsp_js07_end_user.dta"), convert.factors = FALSE)
lfs2007d <- read.dta(paste0(inpath,"lfsp_od07_end_user.dta"), convert.factors = FALSE)

lfs2007a.s <- lfs2007a %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2007b.s <- lfs2007b %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2007c.s <- lfs2007c %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2007d.s <- lfs2007d %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)

lfs2007a.s$YEAR <- rep(2007,nrow(lfs2007a.s))
lfs2007b.s$YEAR <- rep(2007,nrow(lfs2007b.s))
lfs2007c.s$YEAR <- rep(2007,nrow(lfs2007c.s))
lfs2007d.s$YEAR <- rep(2007,nrow(lfs2007d.s))

lfs2007a.s$QUARTER <- rep(1,nrow(lfs2007a.s))
lfs2007b.s$QUARTER <- rep(2,nrow(lfs2007b.s))
lfs2007c.s$QUARTER <- rep(3,nrow(lfs2007c.s))
lfs2007d.s$QUARTER <- rep(4,nrow(lfs2007d.s))

lfs2007a.s$Y_Q <- rep(2007.1,nrow(lfs2007a.s))
lfs2007b.s$Y_Q <- rep(2007.2,nrow(lfs2007b.s))
lfs2007c.s$Y_Q <- rep(2007.3,nrow(lfs2007c.s))
lfs2007d.s$Y_Q <- rep(2007.4,nrow(lfs2007d.s))

lfs2007a.s$FLEXW7 <- rep(NA,nrow(lfs2007a.s))
lfs2007c.s$FLEXW7 <- rep(NA,nrow(lfs2007c.s))

##Don't run rn
lfs2007a.s$WHYUK10 <- rep(NA,nrow(lfs2007a.s))
lfs2007b.s$WHYUK10 <- rep(NA,nrow(lfs2007b.s))
lfs2007c.s$WHYUK10 <- rep(NA,nrow(lfs2007c.s))
lfs2007d.s$WHYUK10 <- rep(NA,nrow(lfs2007d.s))

lfs2007a.s <- rename(lfs2007a.s, c("NATION"="NTNLTY"))
lfs2007b.s <- rename(lfs2007b.s, c("NATION"="NTNLTY"))
lfs2007c.s <- rename(lfs2007c.s, c("NATION"="NTNLTY"))
lfs2007d.s <- rename(lfs2007d.s, c("NATION"="NTNLTY"))

lfs07 <- rbind(lfs2007a.s, lfs2007b.s, lfs2007c.s, lfs2007d.s)
write_csv(lfs07, paste0(outpath, "lfs_07.csv"))

#part 3
lfs2008a <- read.dta(paste0(inpath,"lfsp_jm08_end_user.dta"), convert.factors = FALSE)
lfs2008b <- read.dta(paste0(inpath,"lfsp_aj08_end_user.dta"), convert.factors = FALSE)
lfs2008c <- read.dta(paste0(inpath,"lfsp_js08_end_user.dta"), convert.factors = FALSE)
lfs2008d <- read.dta(paste0(inpath,"lfsp_od08_end_user.dta"), convert.factors = FALSE)
lfs2009a <- read.dta(paste0(inpath,"lfsp_jm09_end_user.dta"), convert.factors = FALSE)
lfs2009b <- read.dta(paste0(inpath,"lfsp_aj09_end_user.dta"), convert.factors = FALSE)
lfs2009c <- read.dta(paste0(inpath,"lfsp_js09_end_user.dta"), convert.factors = FALSE)
lfs2009d <- read.dta(paste0(inpath,"lfsp_od09_end_user.dta"), convert.factors = FALSE)
lfs2010a <- read.dta(paste0(inpath,"lfsp_jm10_end_user.dta"), convert.factors = FALSE)
lfs2010b <- read.dta(paste0(inpath,"lfsp_aj10_end_user.dta"), convert.factors = FALSE)
lfs2010c <- read.dta(paste0(inpath,"lfsp_js10_end_user.dta"), convert.factors = FALSE)
lfs2010d <- read.dta(paste0(inpath,"lfsp_od10_end_user.dta"), convert.factors = FALSE)
lfs2011a <- read.dta(paste0(inpath,"lfsp_jm11_end_user.dta"), convert.factors = FALSE)
lfs2011b <- read.dta(paste0(inpath,"lfsp_aj11_end_user.dta"), convert.factors = FALSE)
lfs2011c <- read.dta(paste0(inpath,"lfsp_js11_end_user.dta"), convert.factors = FALSE)
lfs2011d <- read.dta(paste0(inpath,"lfsp_od11_end_user.dta"), convert.factors = FALSE)

lfs2008a.s <- lfs2008a %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2008b.s <- lfs2008b %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2008c.s <- lfs2008c %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2008d.s <- lfs2008d %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2009a.s <- lfs2009a %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2009b.s <- lfs2009b %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2009c.s <- lfs2009c %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2009d.s <- lfs2009d %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2010a.s <- lfs2010a %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2010b.s <- lfs2010b %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2010c.s <- lfs2010c %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2010d.s <- lfs2010d %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC2KMMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2011a.s <- lfs2011a %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2011b.s <- lfs2011b %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2011c.s <- lfs2011c %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2011d.s <- lfs2011d %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)

lfs2008a.s$YEAR <- rep(2008,nrow(lfs2008a.s))
lfs2008b.s$YEAR <- rep(2008,nrow(lfs2008b.s))
lfs2008c.s$YEAR <- rep(2008,nrow(lfs2008c.s))
lfs2008d.s$YEAR <- rep(2008,nrow(lfs2008d.s))
lfs2009a.s$YEAR <- rep(2009,nrow(lfs2009a.s))
lfs2009b.s$YEAR <- rep(2009,nrow(lfs2009b.s))
lfs2009c.s$YEAR <- rep(2009,nrow(lfs2009c.s))
lfs2009d.s$YEAR <- rep(2009,nrow(lfs2009d.s))
lfs2010a.s$YEAR <- rep(2010,nrow(lfs2010a.s))
lfs2010b.s$YEAR <- rep(2010,nrow(lfs2010b.s))
lfs2010c.s$YEAR <- rep(2010,nrow(lfs2010c.s))
lfs2010d.s$YEAR <- rep(2010,nrow(lfs2010d.s))
lfs2011a.s$YEAR <- rep(2011,nrow(lfs2011a.s))
lfs2011b.s$YEAR <- rep(2011,nrow(lfs2011b.s))
lfs2011c.s$YEAR <- rep(2011,nrow(lfs2011c.s))
lfs2011d.s$YEAR <- rep(2011,nrow(lfs2011d.s))

lfs2008a.s$QUARTER <- rep(1,nrow(lfs2008a.s))
lfs2008b.s$QUARTER <- rep(2,nrow(lfs2008b.s))
lfs2008c.s$QUARTER <- rep(3,nrow(lfs2008c.s))
lfs2008d.s$QUARTER <- rep(4,nrow(lfs2008d.s))
lfs2009a.s$QUARTER <- rep(1,nrow(lfs2009a.s))
lfs2009b.s$QUARTER <- rep(2,nrow(lfs2009b.s))
lfs2009c.s$QUARTER <- rep(3,nrow(lfs2009c.s))
lfs2009d.s$QUARTER <- rep(4,nrow(lfs2009d.s))
lfs2010a.s$QUARTER <- rep(1,nrow(lfs2010a.s))
lfs2010b.s$QUARTER <- rep(2,nrow(lfs2010b.s))
lfs2010c.s$QUARTER <- rep(3,nrow(lfs2010c.s))
lfs2010d.s$QUARTER <- rep(4,nrow(lfs2010d.s))
lfs2011a.s$QUARTER <- rep(1,nrow(lfs2011a.s))
lfs2011b.s$QUARTER <- rep(2,nrow(lfs2011b.s))
lfs2011c.s$QUARTER <- rep(3,nrow(lfs2011c.s))
lfs2011d.s$QUARTER <- rep(4,nrow(lfs2011d.s))

lfs2008a.s$Y_Q <- rep(2008.1,nrow(lfs2008a.s))
lfs2008b.s$Y_Q <- rep(2008.2,nrow(lfs2008b.s))
lfs2008c.s$Y_Q <- rep(2008.3,nrow(lfs2008c.s))
lfs2008d.s$Y_Q <- rep(2008.4,nrow(lfs2008d.s))
lfs2009a.s$Y_Q <- rep(2009.1,nrow(lfs2009a.s))
lfs2009b.s$Y_Q <- rep(2009.2,nrow(lfs2009b.s))
lfs2009c.s$Y_Q <- rep(2009.3,nrow(lfs2009c.s))
lfs2009d.s$Y_Q <- rep(2009.4,nrow(lfs2009d.s))
lfs2010a.s$Y_Q <- rep(2010.1,nrow(lfs2010a.s))
lfs2010b.s$Y_Q <- rep(2010.2,nrow(lfs2010b.s))
lfs2010c.s$Y_Q <- rep(2010.3,nrow(lfs2010c.s))
lfs2010d.s$Y_Q <- rep(2010.4,nrow(lfs2010d.s))
lfs2011a.s$Y_Q <- rep(2011.1,nrow(lfs2011a.s))
lfs2011b.s$Y_Q <- rep(2011.2,nrow(lfs2011b.s))
lfs2011c.s$Y_Q <- rep(2011.3,nrow(lfs2011c.s))
lfs2011d.s$Y_Q <- rep(2011.4,nrow(lfs2011d.s))

lfs2008a.s$FLEXW7 <- rep(NA,nrow(lfs2008a.s))
lfs2008c.s$FLEXW7 <- rep(NA,nrow(lfs2008c.s))
lfs2009a.s$FLEXW7 <- rep(NA,nrow(lfs2009a.s))
lfs2009c.s$FLEXW7 <- rep(NA,nrow(lfs2009c.s))
lfs2010a.s$FLEXW7 <- rep(NA,nrow(lfs2010a.s))
lfs2010c.s$FLEXW7 <- rep(NA,nrow(lfs2010c.s))
lfs2011a.s$FLEXW7 <- rep(NA,nrow(lfs2011a.s))
lfs2011c.s$FLEXW7 <- rep(NA,nrow(lfs2011c.s))

##dont run rn
lfs2008a.s$WHYUK10 <- rep(NA,nrow(lfs2008a.s))
lfs2008b.s$WHYUK10 <- rep(NA,nrow(lfs2008b.s))
lfs2008c.s$WHYUK10 <- rep(NA,nrow(lfs2008c.s))
lfs2008d.s$WHYUK10 <- rep(NA,nrow(lfs2008d.s))
lfs2009a.s$WHYUK10 <- rep(NA,nrow(lfs2009a.s))
lfs2009b.s$WHYUK10 <- rep(NA,nrow(lfs2009b.s))
lfs2009c.s$WHYUK10 <- rep(NA,nrow(lfs2009c.s))
lfs2009d.s$WHYUK10 <- rep(NA,nrow(lfs2009d.s))

lfs2011a.s <- rename(lfs2011a.s, c("SC2KMMJ"="SC10MMJ"))
lfs2011b.s <- rename(lfs2011b.s, c("SC2KMMJ"="SC10MMJ"))
lfs2011c.s <- rename(lfs2011c.s, c("SC2KMMJ"="SC10MMJ"))
lfs2011d.s <- rename(lfs2011d.s, c("SC2KMMJ"="SC10MMJ"))

lfs08.11 <- rbind(lfs2008a.s, lfs2008b.s, lfs2008c.s, lfs2008d.s,
                  lfs2009a.s, lfs2009b.s, lfs2009c.s, lfs2009d.s,
                  lfs2010a.s, lfs2010b.s, lfs2010c.s, lfs2010d.s,
                  lfs2011a.s, lfs2011b.s, lfs2011c.s, lfs2011d.s)
write_csv(lfs08.11, paste0(outpath, "lfs_08-11.csv"))

#part 4
lfs2012a <- read.dta(paste0(inpath,"lfsp_jm12_end_user.dta"), convert.factors = FALSE)
lfs2012b <- read.dta(paste0(inpath,"lfsp_aj12_end_user.dta"), convert.factors = FALSE)
lfs2012c <- read.dta(paste0(inpath,"lfsp_js12_end_user.dta"), convert.factors = FALSE)
lfs2012d <- read.dta(paste0(inpath,"lfsp_od12_end_user.dta"), convert.factors = FALSE)

lfs2012a.s <- lfs2012a %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2012b.s <- lfs2012b %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT14, PWT14, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)
lfs2012c.s <- lfs2012c %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT17, PWT17, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6)
lfs2012d.s <- lfs2012d %>% select(CASENOP, THISWV, FTPTW, HOURPAY, PIWT17, PWT17, NTNLTY12, STAT, CAMEYR, AGE, SEX, EDAGE, SC10MMJ, ILODEFR, NATO7, JOBTYP, TTUSHR, WHYTMP6, FLEXW7)

lfs2012a.s$YEAR <- rep(2012,nrow(lfs2012a.s))
lfs2012b.s$YEAR <- rep(2012,nrow(lfs2012b.s))
lfs2012c.s$YEAR <- rep(2012,nrow(lfs2012c.s))
lfs2012d.s$YEAR <- rep(2012,nrow(lfs2012d.s))

lfs2012a.s$QUARTER <- rep(1,nrow(lfs2012a.s))
lfs2012b.s$QUARTER <- rep(2,nrow(lfs2012b.s))
lfs2012c.s$QUARTER <- rep(3,nrow(lfs2012c.s))
lfs2012d.s$QUARTER <- rep(4,nrow(lfs2012d.s))

lfs2012a.s$Y_Q <- rep(2012.1,nrow(lfs2012a.s))
lfs2012b.s$Y_Q <- rep(2012.2,nrow(lfs2012b.s))
lfs2012c.s$Y_Q <- rep(2012.3,nrow(lfs2012c.s))
lfs2012d.s$Y_Q <- rep(2012.4,nrow(lfs2012d.s))

lfs2012a.s$FLEXW7 <- rep(NA,nrow(lfs2012a.s))
lfs2012c.s$FLEXW7 <- rep(NA,nrow(lfs2012c.s))

lfs2012c.s <- rename(lfs2012c.s, c("PIWT14"= "PIWT17", "PWT14"="PWT17"))
lfs2012d.s <- rename(lfs2012d.s, c("PIWT14"= "PIWT17", "PWT14"="PWT17"))

lfs12 <- rbind(lfs2012a.s, lfs2012b.s, lfs2012c.s, lfs2012d.s)
write_csv(lfs12, paste0(outpath, "lfs_12.csv"))

####
# to combine all 4
####
##reading in data
lfs07 <- read.csv(paste0(outpath,"lfs_07.csv"), stringsAsFactors = F)
lfs08.11 <- read.csv(paste0(outpath,"lfs_08-11.csv"), stringsAsFactors = F)
lfs12 <- read.csv(paste0(outpath,"lfs_12.csv"), stringsAsFactors = F)
lfs13.16 <- read.csv(paste0(outpath,"lfs_13-16.csv"), stringsAsFactors = F)

##merging data
lfs07 <- rename(lfs07, c("NATION" = "NATION", "SC10MMJ" = "SC2KMMJ"))
lfs08.11 <- rename(lfs08.11, c("NATION" = "NTNLTY", "SC10MMJ"="SC2KMMJ"))
lfs12 <- rename(lfs12, c("NATION"="NTNLTY12"))
lfs13.16 <- rename(lfs13.16, c("NATION" = "NTNLTY12","PIWT14" = "PIWT17" , "PWT14"="PWT17" ))

lfs <- rbind (lfs07, lfs08.11, lfs12, lfs13.16)
write_csv(lfs, paste0(outpath,"lfs.csv"))
